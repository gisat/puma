#!/usr/bin/env node

const {SQL} = require('sql-template-strings');
const db = require('../db');

db.init();

if (process.argv.length !== 3) {
    throw new Error('Script expects exactly one parameter - user key.');
}

const userKey = process.argv[2];

db.query(SQL`
INSERT INTO "user"."userPermissions"
  ("userKey", "permissionKey")
SELECT
  ${userKey}, "p"."key"
FROM
  "user"."permissions" "p"
ON CONFLICT DO NOTHING
`);
